<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/style.css" />
    <link
      href="https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <title>Document</title>
    <style>
      /* Buat dua kolom yang sama yang mengapung di samping satu sama lain */
      .column {
        float: left;
        height: 250px; /* Hanya untuk demonstrasi */
      }

      /* Hapus floats setelah columns */
      .row:after {
        content: "";
        display: table;
        clear: both;
      }
    </style>
  </head>
  <body>
    <div class="flex h-full flex-col row column">
      <div class="column">
        <img
          src="/assets/sidebackground.png"
          class=""
          style="width: 719px; height: 700px"
        />
      </div>

      <div
        class="mt-2 sm:max-w-sm justify-between column"
        style="margin-left: 900px"
      >
        <div class="row auth-form">
          <h2 class="text-2xl font-bold">Reset Password</h2>
          <!-- form -->
          <form action="/api/v1/reset-password?_method=PUT" method="POST">
            <div class="field create-password">
              <label class="mt-5 block text-sm font-medium"
                >Masukkan Password Baru</label
              >
              <!-- password -->
              <div class="mb-3 input-field">
                <input
                  type="password"
                  class="form-control form-input border border-top-0 border-start-0 border-end-0 rounded-0 p-0 password"
                  placeholder="Type new password"
                  id="password"
                  name="password"
                  autocomplete="new-password"
                  required
                  style="
                    border-radius: 16px;
                    padding-left: 15px;
                    width: 452px;
                    height: 48px;
                  "
                />
                <input
                  type="hidden"
                  id="token"
                  name="token"
                  value="<%= token %>"
                />
                <i class="bx bx-hide show-hide"></i>
              </div>
              <span class="error password-error">
                <i class="bx bx-error-circle error-icon"></i>
              </span>
            </div>
            <div class="field confirm-password">
              <label class="mt-5 block text-sm font-medium"
                >Ulangi Password Baru</label
              >
              <!-- confirm password -->
              <div class="mb-3 input-field">
                <input
                  type="password"
                  class="form-control form-input border border-top-0 border-start-0 border-end-0 rounded-0 p-0 cPassword"
                  placeholder="Re-type new password"
                  id="confirmPassword"
                  name="confirmPassword"
                  autocomplete="new-password"
                  required
                  style="
                    border-radius: 16px;
                    padding-left: 15px;
                    width: 452px;
                    height: 48px;
                  "
                />
                <i class="bx bx-hide show-hide"></i>
              </div>
              <span class="error cPassword-error">
                <i class="bx bx-error-circle error-icon"></i>
              </span>
            </div>
            <div class="input-field button">
              <button
                type="submit"
                class="btn btn-login my-3"
                style="
                  border-radius: 16px;
                  padding-left: 15px;
                  width: 452px;
                  height: 48px;
                  background-color: #7126b5;
                  color: white;
                "
              >
                <a
                  href="https://c2-backend.up.railway.app/"
                  style="text-decoration: none"
                ></a>
                Submit
              </button>
            </div>
          </form>
          <!-- end form -->
        </div>
      </div>
    </div>
    <!-- JavaScript -->
    <script>
      const form = document.querySelector("form"),
        passField = form.querySelector(".create-password"),
        passInput = passField.querySelector(".password"),
        cPassField = form.querySelector(".confirm-password"),
        cPassInput = cPassField.querySelector(".cPassword");

      // Hide and show password
      const eyeIcons = document.querySelectorAll(".show-hide");

      eyeIcons.forEach((eyeIcon) => {
        eyeIcon.addEventListener("click", () => {
          const pInput = eyeIcon.previousElementSibling; // getting password input
          if (pInput.type === "password") {
            eyeIcon.classList.replace("bx-hide", "bx-show");
            pInput.type = "text";
          } else {
            eyeIcon.classList.replace("bx-show", "bx-hide");
            pInput.type = "password";
          }
        });
      });

      // Password Validation
      function createPass() {
        const passPattern =
          /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

        if (!passInput.value.match(passPattern)) {
          passField.classList.add("invalid");
        } else {
          passField.classList.remove("invalid");
        }
      }

      // Confirm Password Validation
      function confirmPass() {
        if (passInput.value !== cPassInput.value || cPassInput.value === "") {
          cPassField.classList.add("invalid");
        } else {
          cPassField.classList.remove("invalid");
        }
      }

      // Calling Functions on Form Submit
      form.addEventListener("submit", (e) => {
        e.preventDefault(); // Prevent form submission
        createPass();
        confirmPass();

        // Calling functions on keyup
        passInput.addEventListener("keyup", createPass);
        cPassInput.addEventListener("keyup", confirmPass);

        if (
          !passField.classList.contains("invalid") &&
          !cPassField.classList.contains("invalid")
        ) {
          form.submit(); // Submit the form
        }
      });
    </script>
  </body>
</html>
